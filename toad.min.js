(function(win,doc){if(!doc.querySelectorAll)var getElementsByAttribute=function(attr,context){var nodeList=(context||doc).getElementsByTagName("*"),i=nodeList.length,j=0,nodeArray=[];nodeArray.length=i;for(;i>j;j++)if(nodeList[j].getAttribute(attr))nodeArray[j]=nodeList[j];return nodeArray};if(!win.requestAnimationFrame)win.requestAnimationFrame=function(){return win.webkitRequestAnimationFrame||win.mozRequestAnimationFrame||win.oRequestAnimationFrame||win.msRequestAnimationFrame||function(callback){return win.setTimeout(callback,1E3/60)}}();if(!win.cancelAnimationFrame)win.cancelAnimationFrame=function(){return win.webkitCancelRequestAnimationFrame||win.mozCancelAnimationFrame||win.oCancelAnimationFrame||win.msCancelAnimationFrame||function(id){return win.cancelTimeout(id)}}();function addEventHandler(ev,h){win.addEventListener?win.addEventListener(ev,h,!1):win.attachEvent?win.attachEvent("on"+ev,h):win["on"+ev]=h}function removeEventHandler(ev,h){win.removeEventListener?win.removeEventListener(ev,h,!1):win.detachEvent?win.detachEvent("on"+ev,h):win["on"+ev]=null}function isInArray(arr,i,item){while(i--)if(item===arr[i])return true;return false}function isInViewport(el){var r=el.getBoundingClientRect(),wh=win.innerHeight||doc.documentElement.clientHeight||doc.body.clientHeight;return r.top>=0&&r.left>=0&&r.top<=wh}function rebounce(f){var scheduled,context,args,len,i;return function(){context=this;args=[];len=args.length=arguments.length;i=0;for(;i<len;++i)args[i]=arguments[i];win.cancelAnimationFrame(scheduled);scheduled=win.requestAnimationFrame(function(){f.apply(context,args);scheduled=null})}}function prep(){var elements=doc.querySelectorAll("[data-src]")||getElementsByAttribute("data-src"),i=elements.length,j=0;for(;i>j;++j){var this_el=elements[j],styles=!!this_el.getAttribute("style")?this_el.getAttribute("style").split(":"):false,k=!!styles?styles.length:0,shouldBeLoaded=!!this_el.getAttribute("data-src")&&isInViewport(this_el),isImage="img"===this_el.tagName.toLowerCase()&&!this_el.src,needsBgImage=!styles||!isInArray(styles,k,"background-image"),type=isImage?"image":needsBgImage?"bg":"none";if(shouldBeLoaded)load(this_el,type)}if(i<=0)stop()}function load(el,type){switch(type){case "image":el.src=el.getAttribute("data-src");el.removeAttribute("data-src");break;case "bg":el.style.backgroundImage="url("+el.getAttribute("data-src")+")";el.removeAttribute("data-src");break;default:el.removeAttribute("data-src")}}function toad(){return rebounce(prep())}function start(){addEventHandler("load",prep);addEventHandler("scroll",toad);addEventHandler("resize",toad)}function stop(){removeEventHandler("load",prep);removeEventHandler("scroll",toad);removeEventHandler("resize",toad)}win.toad={startListening:start}})(window,window.document);
